<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.xiaochuan.web.repository.QualificationMapper">
  <resultMap id="Qualification" type="com.xiaochuan.web.entity.Qualification">
    <!--<constructor>-->
      <!--<idArg column="id" javaType="int"/>-->
    <!--</constructor>-->
    <id column="id" property="id"/>
    <result column="path" property="path"/>
    <association property="company" javaType="Company">
      <id property="id" column="companyId" />
      <result property="name" column="name"/>
    </association>

  </resultMap>

  <sql id="all_column">
    id,
    company_id,
    path
  </sql>

  <insert id="insert">
    <selectKey keyProperty="id" order="BEFORE" resultType="java.lang.Integer">
      SELECT LAST_INSERT_ID()
    </selectKey>
    INSERT INTO qualification
    <trim prefix="(" suffix=")" suffixOverrides=",">
      <if test="company.id != null">company_id,</if>
      <if test="path != null">path,</if>
    </trim>
    VALUES
    <trim prefix="(" suffix=")" suffixOverrides=",">
      <if test="company.id != null">#{company.id},</if>
      <if test="path != null">#{path},</if>
    </trim>
  </insert>


  <select id="selectAll" resultMap="Qualification">
    SELECT
      t1.id,
      t1.path,
      t2.id as companyId,
      t2.name
    FROM qualification t1 left join company t2 on t1.company_id = t2.id
  </select>

  <select id="select" resultMap="Qualification">
    SELECT
    <include refid="all_column"/>
    FROM qualification
    <!--<if test="pojo != null">-->
    <where>
      <if test="pojo.id != null">AND id = #{pojo.id}</if>
      <if test="pojo.company.id != null">AND company_id = #{pojo.company.id}</if>
      <if test="pojo.path != null">AND path = #{pojo.path}</if>
    </where>
    <!--</if>-->
    LIMIT 1000
  </select>

  <select id="selectById" resultMap="Qualification">
    SELECT
    <include refid="all_column"/>
    FROM qualification
    WHERE id = #{id}
  </select>

  <delete id="delete">
    DELETE FROM qualification where id = #{id}
  </delete>
</mapper>
